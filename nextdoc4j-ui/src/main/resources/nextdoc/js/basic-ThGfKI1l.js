var q=Object.defineProperty;var B=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var O=(a,t,e)=>t in a?q(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,g=(a,t)=>{for(var e in t||(t={}))z.call(t,e)&&O(a,e,t[e]);if(B)for(var e of B(t))H.call(t,e)&&O(a,e,t[e]);return a};var p=(a,t,e)=>new Promise((c,o)=>{var i=s=>{try{w(e.next(s))}catch(l){o(l)}},k=s=>{try{w(e.throw(s))}catch(l){o(l)}},w=s=>s.done?c(s.value):Promise.resolve(s.value).then(i,k);w((e=e.apply(a,t)).next())});import{aa as K,ab as U,b as Y,a as G,ac as Q,T as X,ad as Z,ae as ee,_ as te}from"./bootstrap-ZEN0OeEP.js";import{P as b,ae as $,ax as ae,n as se,a0 as re,a4 as I,J as oe,Y as V,ac as ne,an as v,ao as C,ag as _,aq as f,aD as h,x as R,aI as D,ap as A,aE as E,F as ce,a$ as le,aJ as ie,a1 as M}from"../jse/index-index-Cr6zrOyM.js";import{a as ue}from"./use-refresh-DoNihsdR.js";import{_ as de,a as me}from"./layout.vue_vue_type_script_setup_true_lang-CaMdQNBt.js";import"./load-COJZcUSW.js";import"./button.vue_vue_type_script_setup_true_lang-DFdR4VU-.js";import"./index-B7WQbBuP.js";import"./methods-WRGAQ8mz.js";import"./index-UShHmpll.js";import"./index-C74taGvj.js";const d=b(),P=b(!1),S=b({advancedStyle:{colorStops:[{color:"gray",offset:0},{color:"gray",offset:1}],type:"linear"},content:"",contentType:"multi-line-text",globalAlpha:.25,gridLayoutOptions:{cols:2,gap:[20,20],matrix:[[1,0],[0,1]],rows:2},height:200,layout:"grid",rotate:30,width:160});function pe(){function a(c){return p(this,null,function*(){var i;const{Watermark:o}=yield re(()=>p(null,null,function*(){const{Watermark:k}=yield import("./index.esm-Ofvdfudw.js");return{Watermark:k}}),[],import.meta.url);S.value=g(g({},S.value),c),d.value=new o(S.value),yield(i=d.value)==null?void 0:i.create()})}function t(c){return p(this,null,function*(){var o;d.value?(yield se(),yield(o=d.value)==null?void 0:o.changeOptions(g(g({},S.value),c))):yield a(c)})}function e(){d.value&&(d.value.destroy(),d.value=void 0)}return P.value||(P.value=!0,$(()=>{e()})),{destroyWatermark:e,updateWatermark:t,watermark:ae(d)}}const fe={class:"selector-label"},ve={key:0,class:"selector-dropdown"},_e=["onClick"],ke={class:"item-name"},we={key:0,class:"item-check",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},ge=I({__name:"service-selector",setup(a){const t=K(),e=U(),c=Y(),o=ue(),i=G(),{isAggregation:k,services:w,currentService:s}=Q(t),l=b(!1),T=b(null),N=oe(()=>{var n;return((n=s.value)==null?void 0:n.name)||"选择服务"}),j=()=>{l.value=!l.value},x=()=>{l.value=!1},F=n=>p(null,null,function*(){var m;if(n.url===((m=s.value)==null?void 0:m.url)){x();return}const u=o.getTabs,r=i.currentRoute.value.fullPath;t.saveCurrentTabsState(u,r),t.switchService(n),x()});V(s,(n,u)=>p(null,null,function*(){if(!(!n||!u||n.url===u.url))try{const r=t.getServiceTabsState(n),m=r.currentTab||"/home";c.resetConfig(),yield o.closeAllTabs(i);const{accessibleMenus:y,accessibleRoutes:L}=yield Z({roles:[],router:i,routes:ee});e.setAccessMenus(y),e.setAccessRoutes(L),e.setIsAccessChecked(!0),r.tabs.length>0&&r.tabs.forEach(J=>{o.addTab(J)}),yield i.replace(m)}catch(r){console.error("Error switching service:",r)}}));const W=n=>{T.value&&!T.value.contains(n.target)&&x()};return ne(()=>{document.addEventListener("click",W)}),$(()=>{document.removeEventListener("click",W)}),(n,u)=>_(k)?(f(),v("div",{key:0,ref_key:"dropdownRef",ref:T,class:"docs-selector"},[h("button",{type:"button",class:A(["selector-button",{"is-open":l.value}]),onClick:j},[h("span",fe,D(N.value),1),(f(),v("svg",{class:A(["selector-arrow",{"rotate-180":l.value}]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},u[0]||(u[0]=[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 9l-7 7-7-7"},null,-1)]),2))],2),R(X,{name:"dropdown"},{default:E(()=>[l.value?(f(),v("div",ve,[(f(!0),v(ce,null,le(_(w),r=>{var m,y;return f(),v("div",{key:r.url,class:A(["selector-item",{"is-active":((m=_(s))==null?void 0:m.url)===r.url}]),onClick:L=>F(r)},[h("span",ke,D(r.name),1),((y=_(s))==null?void 0:y.url)===r.url?(f(),v("svg",we,u[1]||(u[1]=[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1)]))):C("",!0)],10,_e)}),128))])):C("",!0)]),_:1})],512)):C("",!0)}}),he=te(ge,[["__scopeId","data-v-8fc1a9b1"]]),Be=I({__name:"basic",setup(a){const{destroyWatermark:t,updateWatermark:e}=pe();return V(()=>M.app.watermark,c=>p(null,null,function*(){c?yield e({content:M.app.watermarkContent}):t()}),{immediate:!0}),(c,o)=>(f(),ie(_(me),null,{"lock-screen":E(()=>[R(_(de))]),"menu-before":E(()=>[R(he)]),_:1}))}});export{Be as default};
