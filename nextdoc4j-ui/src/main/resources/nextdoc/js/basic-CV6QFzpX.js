var q=Object.defineProperty;var B=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var O=(s,t,e)=>t in s?q(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,g=(s,t)=>{for(var e in t||(t={}))z.call(t,e)&&O(s,e,t[e]);if(B)for(var e of B(t))H.call(t,e)&&O(s,e,t[e]);return s};var f=(s,t,e)=>new Promise((c,n)=>{var i=r=>{try{w(e.next(r))}catch(l){n(l)}},k=r=>{try{w(e.throw(r))}catch(l){n(l)}},w=r=>r.done?c(r.value):Promise.resolve(r.value).then(i,k);w((e=e.apply(s,t)).next())});import{ar as K,ac as U,b as Y,a as G,as as Q,a7 as X,at as Z,au as ee,_ as te}from"./bootstrap-atv0L1PC.js";import{P as b,a7 as $,ax as ae,n as se,a0 as re,a4 as I,J as oe,Y as V,a6 as ne,ao as _,ap as S,ah as v,ar as m,aD as h,x as R,aI as D,aq as A,aE as E,F as ce,a$ as le,aJ as ie,a1 as M}from"../jse/index-index-CJFR8bbq.js";import{a as ue}from"./use-refresh-B7g-iKYC.js";import{_ as de,a as me}from"./layout.vue_vue_type_script_setup_true_lang-t3ro8mIO.js";import"./button.vue_vue_type_script_setup_true_lang-DFrCktSZ.js";import"./index-B7WQbBuP.js";import"./methods-WRGAQ8mz.js";import"./index-BJe3Fm9H.js";const d=b(),P=b(!1),T=b({advancedStyle:{colorStops:[{color:"gray",offset:0},{color:"gray",offset:1}],type:"linear"},content:"",contentType:"multi-line-text",globalAlpha:.25,gridLayoutOptions:{cols:2,gap:[20,20],matrix:[[1,0],[0,1]],rows:2},height:200,layout:"grid",rotate:30,width:160});function pe(){function s(c){return f(this,null,function*(){var i;const{Watermark:n}=yield re(()=>f(null,null,function*(){const{Watermark:k}=yield import("./index.esm-Ofvdfudw.js");return{Watermark:k}}),[],import.meta.url);T.value=g(g({},T.value),c),d.value=new n(T.value),yield(i=d.value)==null?void 0:i.create()})}function t(c){return f(this,null,function*(){var n;d.value?(yield se(),yield(n=d.value)==null?void 0:n.changeOptions(g(g({},T.value),c))):yield s(c)})}function e(){d.value&&(d.value.destroy(),d.value=void 0)}return P.value||(P.value=!0,$(()=>{e()})),{destroyWatermark:e,updateWatermark:t,watermark:ae(d)}}const fe={class:"selector-label"},_e={key:0,class:"selector-dropdown"},ve=["onClick"],ke={class:"item-name"},we={key:0,class:"item-status"},ge={key:1,class:"item-check",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},he=I({__name:"service-selector",setup(s){const t=K(),e=U(),c=Y(),n=ue(),i=G(),{isAggregation:k,services:w,currentService:r}=Q(t),l=b(!1),x=b(null),N=oe(()=>{var o;return((o=r.value)==null?void 0:o.name)||"选择服务"}),j=()=>{l.value=!l.value},C=()=>{l.value=!1},F=o=>f(null,null,function*(){var p;if(o.disabled)return;if(o.url===((p=r.value)==null?void 0:p.url)){C();return}const u=n.getTabs,a=i.currentRoute.value.fullPath;t.saveCurrentTabsState(u,a),t.switchService(o),C()});V(r,(o,u)=>f(null,null,function*(){if(!(!o||!u||o.url===u.url))try{const a=t.getServiceTabsState(o),p=a.currentTab||"/home";c.resetConfig(),yield n.closeAllTabs(i);const{accessibleMenus:y,accessibleRoutes:L}=yield Z({roles:[],router:i,routes:ee});e.setAccessMenus(y),e.setAccessRoutes(L),e.setIsAccessChecked(!0),a.tabs.length>0&&a.tabs.forEach(J=>{n.addTab(J)}),yield i.replace(p)}catch(a){console.error("Error switching service:",a)}}));const W=o=>{x.value&&!x.value.contains(o.target)&&C()};return ne(()=>{document.addEventListener("click",W)}),$(()=>{document.removeEventListener("click",W)}),(o,u)=>v(k)?(m(),_("div",{key:0,ref_key:"dropdownRef",ref:x,class:"docs-selector"},[h("button",{type:"button",class:A(["selector-button",{"is-open":l.value}]),onClick:j},[h("span",fe,D(N.value),1),(m(),_("svg",{class:A(["selector-arrow",{"rotate-180":l.value}]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},u[0]||(u[0]=[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 9l-7 7-7-7"},null,-1)]),2))],2),R(X,{name:"dropdown"},{default:E(()=>[l.value?(m(),_("div",_e,[(m(!0),_(ce,null,le(v(w),a=>{var p,y;return m(),_("div",{key:a.url,class:A(["selector-item",{"is-active":((p=v(r))==null?void 0:p.url)===a.url,"is-disabled":a.disabled}]),onClick:L=>F(a)},[h("span",ke,D(a.name),1),a.disabled?(m(),_("span",we,"不可用")):S("",!0),((y=v(r))==null?void 0:y.url)===a.url?(m(),_("svg",ge,u[1]||(u[1]=[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1)]))):S("",!0)],10,ve)}),128))])):S("",!0)]),_:1})],512)):S("",!0)}}),be=te(he,[["__scopeId","data-v-37663cd1"]]),Le=I({__name:"basic",setup(s){const{destroyWatermark:t,updateWatermark:e}=pe();return V(()=>M.app.watermark,c=>f(null,null,function*(){c?yield e({content:M.app.watermarkContent}):t()}),{immediate:!0}),(c,n)=>(m(),ie(v(me),null,{"lock-screen":E(()=>[R(v(de))]),"menu-before":E(()=>[R(be)]),_:1}))}});export{Le as default};
